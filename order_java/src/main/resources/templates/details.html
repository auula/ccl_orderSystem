<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>å•†å“è¯¦æƒ…</title>
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport"/>
    <meta content="yes" name="apple-mobile-web-app-capable"/>
    <meta content="black" name="apple-mobile-web-app-status-bar-style"/>
    <meta content="telephone=no" name="format-detection"/>
    <!-- å¼•å…¥YDUIæ ·å¼ -->
    <link rel="stylesheet" th:href="@{/static/css/ydui.css}"/>
    <!-- å¼•å…¥YDUIè‡ªé€‚åº”è§£å†³æ–¹æ¡ˆç±»åº“ -->
    <script th:src="@{/static/js/ydui.flexible.js}"></script>
</head>
<body>

<section class="g-flexview" style="background-color: #FFFFFF;">



    <div class="g-scrollview">
        <div class="m-slider">
            <!-- å‚æ•°åœ¨è¿™é‡Œ -->
            <div class="slider-wrapper">
                <div class="slider-item" th:each="pic : ${p_pic}">
                    <a href="#">
                        <img th:src="${pic.getPicUrl()}">
                    </a>
                </div>
            </div>
            <div class="slider-pagination"></div><!-- åˆ†é¡µæ ‡è¯† -->
        </div>
        <div class="m-cell" style="margin-bottom: 5px">
            <label class="cell-item" style="pointer-events: none;">
                <span class="cell-left">åç§°:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em
                        th:text="${Products.getProductName()}"></em></span>
                <label class="cell-right">
                    <span class="badge badge-radius badge-warning"
                          th:if="${new java.util.Date().getTime() - Products.getCreateTime().getTime() < 86400000L}">æ–° å“</span>
                </label>
            </label>
            <label class="cell-item" style="pointer-events: none;">
                <p class="cell-left">ä»·æ ¼:&nbsp;&nbsp;&nbsp;&nbsp;<samp style="color: red;">ï¿¥<em
                        th:text="${Products.getProductMoney()}"></em>/ä»½</samp></p>
                <label class="cell-right">
                    <span class="badge badge-primary">è‡ªå¸¦ä¸€ä»½ç±³é¥­ğŸš</span>
                </label>
            </label>
            <label class="cell-item" th:if="${Products.getProductName()} ne 'æ— æ•°æ®ï¼'">
                <p class="cell-left">å•†å“æ•°é‡:&nbsp;&nbsp;</p>
                <label class="cell-right">
                    <a href="javascript:initAdd()" class="addCart btn btn-danger">åŠ  å…¥ è´­ ç‰© è½¦</a>
                    <span class="m-spinner" id="J_Quantity">
                        <a href="javascript:;" class="J_Del"></a>
                        <input type="text" class="J_Input" value="1" placeholder=""/>
                        <a href="javascript:;" class="J_Add"></a>
                    </span>
                </label>
            </label>
        </div>
        <div class="m-celltitle" style="">æ›´å¤šè¯¦æƒ…</div>
        <div class="m-cell">
            <div class="cell-item">
                <div class="cell-right">
                    <p class="cell-textarea" style="text-align: left;" th:text="${Products.getProductDetails()}"></p>
                </div>
            </div>
        </div>
    </div>

    <footer class="m-tabbar" style="margin-bottom: 8px;" `>
        <a href="/view/menus" class="tabbar-item ">
					<span class="tabbar-icon">
						<i class="icon-order"></i>
					</span>
            <span class="tabbar-txt">èœå•</span>
        </a>
        <a href="/view/shop_cart" class="tabbar-item">
					<span class="tabbar-icon">
						<i class="icon-shopcart-outline"></i>
					</span>
            <span class="tabbar-txt">è´­ç‰©è½¦</span>
        </a>
        <a href="#" class="tabbar-item">
					<span class="tabbar-icon">
						<i class="icon-ucenter-outline"></i>
					</span>
            <span class="tabbar-txt">ä¸ªäººä¸­å¿ƒ</span>
        </a>
    </footer>
</section>


<!-- å¼•å…¥jQuery 2.0+ -->
<script th:src="@{/static/js/jquery.min.js}"></script>
<!-- å¼•å…¥YDUIè„šæœ¬ -->
<script th:src="@{/static/js/ydui.js}"></script>
<script type="text/javascript" th:inline="javascript">
    var count = 0;
    $(function () {
        //view loading å®Œæˆå°±éšè— spinner
        $(".m-spinner").hide();
        //å½“ç”¨æˆ·ç‚¹å‡» åŠ å…¥è´­ç‰©è½¦æŒ‰é’® åˆ™æ˜¾ç¤ºspinner
        $(".addCart").click(function () {
            $(".addCart").hide();
            $(".m-spinner").show();
        });

    });

    $('#J_Quantity').spinner({
        input: '.J_Input',
        add: '.J_Add',
        minus: '.J_Del',
        unit: 1,
        max: 0,
        callback: function (value, $ele) {
            const shop_form = {
                "id": [[${Products.getProductId()}]],
                "number": value
            }
            if (count >= 1) {//åªè¦countå¤§äºæ‰å»æ·»åŠ 
                $.post("/api_v1/shop_cart/list", shop_form, function (result) {
                    console.log(JSON.stringify(result))
                })
            }
            ++count;//countä½œç”¨æ˜¯é˜²æ­¢é¡µé¢åŠ è½½å®Œæˆ ç¨‹åºå°±é»˜è®¤è‡ªåŠ¨å‘é€äº†ä¸€ä¸ªå•†å“æ·»åŠ è¯·æ±‚
        }
    });

    function  initAdd() {
        const shop_form = {
            "id": [[${Products.getProductId()}]],
            "number": 1
        }
        $.post("/api_v1/shop_cart/list", shop_form, function (result) {
            console.log(JSON.stringify(result))
        })
    }
</script>
</body>
</html>
